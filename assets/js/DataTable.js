

let postshadir = [
    {
        no: 1,
        nama: 'Naufal Muzaki',
        tanggal: '12/2/2024',
        lokabsen: 'Kampus Kimia',
        jammsk: '16:33:1',
        jamklr: '20:11:9',
        aksi: [],
    },
    {
        no: 2,
        nama: 'Aulia Rahman',
        tanggal: '12/3/2024',
        lokabsen: 'Kampus Teknik',
        jammsk: '08:00:0',
        jamklr: '12:30:0',
        aksi: [],
    },
    {
        no: 3,
        nama: 'Siti Nurhaliza',
        tanggal: '12/4/2024',
        lokabsen: 'Kampus Ekonomi',
        jammsk: '09:15:0',
        jamklr: '14:00:0',
        aksi: [],
    },
    {
        no: 4,
        nama: 'Rudi Hartono',
        tanggal: '12/5/2024',
        lokabsen: 'Kampus Hukum',
        jammsk: '10:00:0',
        jamklr: '15:45:0',
        aksi: [],
    },
    {
        no: 5,
        nama: 'Diana Pratiwi',
        tanggal: '12/6/2024',
        lokabsen: 'Kampus Sains',
        jammsk: '11:30:0',
        jamklr: '17:00:0',
        aksi: [],
    },
    {
        no: 6,
        nama: 'Fajar Hidayat',
        tanggal: '12/7/2024',
        lokabsen: 'Kampus Seni',
        jammsk: '12:00:0',
        jamklr: '18:30:0',
        aksi: [],
    },
];


let postsizin = [
    {
        no: 1,
        nama: 'Budi Santoso',
        izin: 'Pulang Lebih Awal',
        tanggal: '12/2/2024',
        jam: '14:30:1',
        keterangan: 'Sakit',
        Status: 'Menunggu Konfirmasi',
    },
    {
        no: 2,
        nama: 'Aulia Rahman',
        izin: 'Cuti',
        tanggal: '12/3/2024',
        jam: 'N/A',
        keterangan: 'Acara Keluarga',
        Status: 'Disetujui',
    },
    {
        no: 3,
        nama: 'Siti Nurhaliza',
        izin: 'Sakit',
        tanggal: '12/4/2024',
        jam: 'N/A',
        keterangan: 'Flu',
        Status: 'Menunggu Konfirmasi',
    },
    {
        no: 4,
        nama: 'Rudi Hartono',
        izin: 'Pulang Lebih Awal',
        tanggal: '12/5/2024',
        jam: '16:00:0',
        keterangan: 'Keluarga',
        Status: 'Ditolak',
    },
    {
        no: 5,
        nama: 'Diana Pratiwi',
        izin: 'Cuti',
        tanggal: '12/6/2024',
        jam: 'N/A',
        keterangan: 'Liburan',
        Status: 'Disetujui',
    },
    {
        no: 6,
        nama: 'Fajar Hidayat',
        izin: 'Sakit',
        tanggal: '12/7/2024',
        jam: 'N/A',
        keterangan: 'Demam',
        Status: 'Menunggu Konfirmasi',
    },
    {
        no: 7,
        nama: 'Indah Lestari',
        izin: 'Pulang Lebih Awal',
        tanggal: '12/8/2024',
        jam: '15:30:0',
        keterangan: 'Penting',
        Status: 'Ditolak',
    },
    {
        no: 8,
        nama: 'Lina Safitri',
        izin: 'Cuti',
        tanggal: '12/9/2024',
        jam: 'N/A',
        keterangan: 'Menemani Orang Tua',
        Status: 'Disetujui',
    },
];

let postsjabatan = [
        {
            no: 1,
            kodejabatan: 'JBT001',
            jabatan: 'Staff',
            aksi: [],
        },
        {
            no: 2,
            kodejabatan: 'JBT002',
            jabatan: 'Supervisor',
            aksi: [],
        },
        {
            no: 3,
            kodejabatan: 'JBT003',
            jabatan: 'Manager',
            aksi: [],
        },
        {
            no: 4,
            kodejabatan: 'JBT004',
            jabatan: 'Assistant Manager',
            aksi: [],
        },
        {
            no: 5,
            kodejabatan: 'JBT005',
            jabatan: 'Director',
            aksi: [],
        },    
];

let postslembur = [
    {
        no: 1,
        nama: 'Budi Santoso',
        izin: 'Pulang Lebih Awal',
        tanggal: '12/2/2024',
        jamlbr: '14:30:1',
        keperluanlbr: 'Printer',
        Status: 'Menunggu Konfirmasi',
    },
    {
        no: 2,
        nama: 'Aulia Rahman',
        izin: 'Lembur',
        tanggal: '12/3/2024',
        jamlbr: '17:00:0',
        keperluanlbr: 'Meeting dengan Klien',
        Status: 'Disetujui',
    },
    {
        no: 3,
        nama: 'Siti Nurhaliza',
        izin: 'Pulang Lebih Awal',
        tanggal: '12/4/2024',
        jamlbr: '15:00:0',
        keperluanlbr: 'Keluarga',
        Status: 'Menunggu Konfirmasi',
    },
    {
        no: 4,
        nama: 'Rudi Hartono',
        izin: 'Lembur',
        tanggal: '12/5/2024',
        jamlbr: '18:00:0',
        keperluanlbr: 'Proyek Mendesak',
        Status: 'Ditolak',
    },
    {
        no: 5,
        nama: 'Diana Pratiwi',
        izin: 'Pulang Lebih Awal',
        tanggal: '12/6/2024',
        jamlbr: '16:00:0',
        keperluanlbr: 'Dokter',
        Status: 'Menunggu Konfirmasi',
    },
    {
        no: 6,
        nama: 'Fajar Hidayat',
        izin: 'Lembur',
        tanggal: '12/7/2024',
        jamlbr: '19:00:0',
        keperluanlbr: 'Pekerjaan Tambahan',
        Status: 'Disetujui',
    },
    {
        no: 7,
        nama: 'Indah Lestari',
        izin: 'Pulang Lebih Awal',
        tanggal: '12/8/2024',
        jamlbr: '15:30:0',
        keperluanlbr: 'Kepentingan Pribadi',
        Status: 'Ditolak',
    },
];


let posts = [
    {
        no: 1,
        kode: 'JS001',
        nama: 'Naufal Muzaki',
        email: 'naufalhh@gmail.com',
        alamat: 'Jl. Habib novel 1 No.99, Rt 003/Rw 001 Pewarna Merah',
        jabatan: 'Kepala Cabang',
        aksi: [],
    },
    {
        no: 2,
        kode: 'JS002',
        nama: 'Aulia Rahman',
        email: 'auliarahman@gmail.com',
        alamat: 'Jl. Melati No. 12, Rt 005/Rw 003',
        jabatan: 'Manager Pemasaran',
        aksi: [],
    },
    {
        no: 3,
        kode: 'JS003',
        nama: 'Siti Nurhaliza',
        email: 'sitinurhaliza@gmail.com',
        alamat: 'Jl. Kenanga No. 45, Rt 002/Rw 001',
        jabatan: 'Staff HR',
        aksi: [],
    },
    {
        no: 4,
        kode: 'JS004',
        nama: 'Rudi Hartono',
        email: 'rudihartono@gmail.com',
        alamat: 'Jl. Flamboyan No. 19, Rt 004/Rw 006',
        jabatan: 'Analyst Keuangan',
        aksi: [],
    },
    {
        no: 5,
        kode: 'JS005',
        nama: 'Diana Pratiwi',
        email: 'dianapratiwi@gmail.com',
        alamat: 'Jl. Mawar No. 21, Rt 003/Rw 002',
        jabatan: 'Staff IT',
        aksi: [],
    },
    {
        no: 6,
        kode: 'JS006',
        nama: 'Budi Santoso',
        email: 'budisantoso@gmail.com',
        alamat: 'Jl. Kamboja No. 34, Rt 007/Rw 005',
        jabatan: 'Kepala Proyek',
        aksi: [],
    },
    {
        no: 7,
        kode: 'JS007',
        nama: 'Tina Kurniasari',
        email: 'tinakurniasari@gmail.com',
        alamat: 'Jl. Bougenville No. 78, Rt 005/Rw 007',
        jabatan: 'Asisten Administrasi',
        aksi: [],
    },
    {
        no: 8,
        kode: 'JS008',
        nama: 'Rizki Aditya',
        email: 'rizkiaditya@gmail.com',
        alamat: 'Jl. Anggrek No. 25, Rt 006/Rw 008',
        jabatan: 'Marketing Executive',
        aksi: [],
    },
    {
        no: 9,
        kode: 'JS009',
        nama: 'Eka Putri',
        email: 'ekaputri@gmail.com',
        alamat: 'Jl. Teratai No. 63, Rt 007/Rw 009',
        jabatan: 'Account Manager',
        aksi: [],
    },
    {
        no: 10,
        kode: 'JS010',
        nama: 'Mulyadi',
        email: 'mulyadi@gmail.com',
        alamat: 'Jl. Cempaka No. 5, Rt 004/Rw 003',
        jabatan: 'Data Scientist',
        aksi: [],
    },
    {
        no: 11,
        kode: 'JS011',
        nama: 'Indah Lestari',
        email: 'indahlestari@gmail.com',
        alamat: 'Jl. Kaktus No. 10, Rt 003/Rw 005',
        jabatan: 'Kepala Divisi',
        aksi: [],
    },
    {
        no: 12,
        kode: 'JS012',
        nama: 'Lina Safitri',
        email: 'linasafitri@gmail.com',
        alamat: 'Jl. Palem No. 99, Rt 001/Rw 002',
        jabatan: 'Staff Pengembangan Produk',
        aksi: [],
    },
    {
        no: 13,
        kode: 'JS013',
        nama: 'Nadia Nurfadila',
        email: 'nadianurfadila@gmail.com',
        alamat: 'Jl. Bunga No. 33, Rt 008/Rw 001',
        jabatan: 'Kepala IT',
        aksi: [],
    },
    {
        no: 14,
        kode: 'JS014',
        nama: 'Fajar Hidayat',
        email: 'fajarhidayat@gmail.com',
        alamat: 'Jl. Cempaka No. 88, Rt 002/Rw 004',
        jabatan: 'Teknisi Jaringan',
        aksi: [],
    }
];

let kodeCounter = posts.length + 1; // Mulai dari panjang array posts + 1 untuk kode selanjutnya

let currentEditId = null;

// Update statistics display
function updateStats() {
    // Count absen for today
    const todayAbsens = postshadir.filter(absen => isToday(absen.tanggal)).length;

    // Count izin with status "Menunggu Konfirmasi"
    const waitingIzinCount = postsizin.filter(izin => izin.Status === 'Menunggu Konfirmasi').length;

    // Count lembur with status "Menunggu Konfirmasi"
    const waitingLemburCount = postslembur.filter(lembur => lembur.Status === 'Menunggu Konfirmasi').length;

    // Update the display
    document.getElementById('Data').innerText = posts.length; // Total data
    document.getElementById('Absen').innerText = todayAbsens; // Total hadir hari ini
    document.getElementById('Izin').innerText = waitingIzinCount; // Total izin menunggu konfirmasi
    document.getElementById('Lembur').innerText = waitingLemburCount; // Total lembur menunggu konfirmasi
}

// Display posts in table
function displayPosts() {
    const postList = document.getElementById('postList');
    postList.innerHTML = ''; // Clear the current list

    posts.forEach((post, index) => {
        const row = document.createElement('tr');
        row.innerHTML = 
            `<td>${index + 1}</td>
            <td>${post.kode}</td>
            <td>${post.nama}</td>
            <td>${post.email}</td>
            <td>${post.alamat}</td>
            <td>${post.jabatan}</td>
            <td>
                <button onclick="viewPost(${post.no})">Lihat</button>
                <button onclick="openEditModal(${post.no})">Edit</button>
                <button onclick="deletePost(${post.no})">Hapus</button>
            </td>`;
        postList.appendChild(row);
    });
}


// Display posts in table jabatan
function displayhjbt() {
    const postjabatan = document.getElementById('postjabatan');
    postjabatan.innerHTML = ''; // Clear the current list

    postsjabatan.forEach((post, index) => {
        const row = document.createElement('tr');
        row.innerHTML = 
            `<td>${index + 1}</td>
            <td>${post.kodejabatan}</td>
            <td>${post.jabatan}</td>
            <td>
                <button onclick="openEditModal(${post.no})">Edit</button>
                <button onclick="deletePost(${post.no})">Hapus</button>
            </td>`;
        postjabatan.appendChild(row);
    });
}

// Fungsi untuk menghitung dan menampilkan jumlah pegawai
function updateEmployeeCount() {
    const count = posts.length; // Hitung jumlah data dalam array posts
    document.getElementById('employeeCount').innerText = count; // Tampilkan jumlah pegawai
}

function openPostModal() {
    // Menampilkan modal dengan menambahkan kelas 'show'
    document.getElementById('Absen').classList.add('show');
    
    // Mengubah teks pada elemen dengan ID 'Data' untuk menampilkan 'Tambah Postingan'
    document.getElementById('Data').innerText = 'Tambah Postingan';
    
    // Mengatur nilai input untuk izin dan lembur ke string kosong
    document.getElementById('Izin').value = '';
    document.getElementById('Lembur').value = '';
    
    // Mengatur ID saat ini untuk pengeditan menjadi null
    currentEditId = null;
}


function viewPost(no) {
    const post = posts.find(p => p.no === no);
    if (post) {
        alert(`Lihat Postingan:\n\nNama: ${post.nama}\nEmail: ${post.email}\nAlamat: ${post.alamat}\nJabatan: ${post.jabatan}`);
        // Atau bisa menampilkan informasi ini dalam modal atau elemen lain di halaman
    }
}

function deletePost(postNo) {
    posts = posts.filter(post => post.no !== postNo);
    displayPosts();
    alert(`Post with No: ${postNo} has been deleted`);
}
// Close modal
function closePostModal() {
    document.getElementById('postModal').classList.remove('show');
}

displayhjbt();
displayPosts();
updateStats();
closePostModal();

// Save post
document.getElementById('postForm').onsubmit = function (e) {
    e.preventDefault();
    const title = document.getElementById('postTitle').value;
    const content = document.getElementById('postContent').value;
    const date = new Date().toLocaleDateString();

    if (currentEditId !== null) {
        // Update existing post
        const index = posts.findIndex(p => p.no === currentEditId);
        if (index !== -1) {
            posts[index] = { id: currentEditId, title, content, date, comments: posts[index].comments };
        }
    } else {
        // Add new post
        const newPost = { no: Date.now(), title, content, date, comments: [] };
        posts.push(newPost);
    }
    displayPosts();
    updateStats();
    closePostModal();
}